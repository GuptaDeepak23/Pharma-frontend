{"ast":null,"code":"import{useState}from\"react\";import{motion}from\"framer-motion\";import{Upload,Camera,Loader2,AlertCircle,CheckCircle2,Palette,TrendingUp,Info}from\"lucide-react\";import{Button}from\"@/components/ui/button\";import ColorPicker from\"@/components/ColorPicker\";import axios from\"axios\";import{toast}from\"sonner\";import{useTranslation}from\"react-i18next\";// const BACKEND_URL ='https://pharmacy-project-lh5x.onrender.com';\nimport{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const BACKEND_URL='https://pharmacy-project-lzv7.onrender.com';const API=\"\".concat(BACKEND_URL,\"/api\");export default function Detection(){const[selectedFile,setSelectedFile]=useState(null);const[preview,setPreview]=useState(null);const[loading,setLoading]=useState(false);const[result,setResult]=useState(null);const[manualColor,setManualColor]=useState(null);const[useManualColor,setUseManualColor]=useState(false);const{t}=useTranslation();const handleFileSelect=e=>{const file=e.target.files[0];if(file){setSelectedFile(file);setResult(null);setManualColor(null);setUseManualColor(false);// Create preview\nconst reader=new FileReader();reader.onloadend=()=>{setPreview(reader.result);};reader.readAsDataURL(file);}};const handleAnalysis=async()=>{if(!selectedFile){toast.error(t(\"detection.clickToUpload\"));return;}setLoading(true);setResult(null);try{const formData=new FormData();formData.append(\"file\",selectedFile);// Add manual color if user selected one\nif(useManualColor&&manualColor){console.log(\"ðŸŽ¨ Sending manual color:\",manualColor);formData.append(\"manual_color\",JSON.stringify(manualColor));}else{console.log(\"ðŸ”„ Using automatic detection\");}console.log(\"\\uD83C\\uDF10 Sending request to: \".concat(API,\"/analyze\"));const response=await axios.post(\"\".concat(API,\"/analyze\"),formData,{headers:{\"Content-Type\":\"multipart/form-data\"},withCredentials:false// Don't send credentials for CORS\n});console.log(\"âœ… API Response:\",response.data);setResult(response.data);toast.success(t(\"detection.analysisResults\"));}catch(error){var _error$response,_error$response$data;console.error(\"Analysis error:\",error);toast.error(((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.detail)||t(\"detection.loadingText\"));}finally{setLoading(false);}};const handleColorSelect=color=>{setManualColor(color);setUseManualColor(true);};const handleColorReset=()=>{setManualColor(null);setUseManualColor(false);};const getStatusColor=status=>{if(status===\"Safe\")return\"text-green-600 bg-green-50\";if(status.includes(\"Slight\"))return\"text-yellow-600 bg-yellow-50\";if(status===\"Contaminated\")return\"text-orange-600 bg-orange-50\";return\"text-red-600 bg-red-50\";};const getStatusIcon=status=>{if(status===\"Safe\")return/*#__PURE__*/_jsx(\"div\",{\"x-file-name\":\"Detection\",\"x-line-number\":\"98\",\"x-component\":\"CheckCircle2\",\"x-id\":\"Detection_98\",\"x-dynamic\":\"false\",\"data-debug-wrapper\":\"true\",style:{display:\"contents\"},children:/*#__PURE__*/_jsx(CheckCircle2,{className:\"h-6 w-6\"})});return/*#__PURE__*/_jsx(\"div\",{\"x-file-name\":\"Detection\",\"x-line-number\":\"99\",\"x-component\":\"AlertCircle\",\"x-id\":\"Detection_99\",\"x-dynamic\":\"false\",\"data-debug-wrapper\":\"true\",style:{display:\"contents\"},children:/*#__PURE__*/_jsx(AlertCircle,{className:\"h-6 w-6\"})});};const getConfidenceColor=score=>{if(score>=80)return\"text-green-600 bg-green-50\";if(score>=60)return\"text-yellow-600 bg-yellow-50\";return\"text-red-600 bg-red-50\";};const getConfidenceIcon=score=>{if(score>=80)return/*#__PURE__*/_jsx(\"div\",{\"x-file-name\":\"Detection\",\"x-line-number\":\"109\",\"x-component\":\"TrendingUp\",\"x-id\":\"Detection_109\",\"x-dynamic\":\"false\",\"data-debug-wrapper\":\"true\",style:{display:\"contents\"},children:/*#__PURE__*/_jsx(TrendingUp,{className:\"h-4 w-4\"})});if(score>=60)return/*#__PURE__*/_jsx(\"div\",{\"x-file-name\":\"Detection\",\"x-line-number\":\"110\",\"x-component\":\"AlertCircle\",\"x-id\":\"Detection_110\",\"x-dynamic\":\"false\",\"data-debug-wrapper\":\"true\",style:{display:\"contents\"},children:/*#__PURE__*/_jsx(AlertCircle,{className:\"h-4 w-4\"})});return/*#__PURE__*/_jsx(\"div\",{\"x-file-name\":\"Detection\",\"x-line-number\":\"111\",\"x-component\":\"AlertCircle\",\"x-id\":\"Detection_111\",\"x-dynamic\":\"false\",\"data-debug-wrapper\":\"true\",style:{display:\"contents\"},children:/*#__PURE__*/_jsx(AlertCircle,{className:\"h-4 w-4\"})});};return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen py-20 px-4\",\"x-file-name\":\"Detection\",\"x-line-number\":\"115\",\"x-component\":\"div\",\"x-id\":\"Detection_115\",\"x-dynamic\":\"false\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-4xl mx-auto\",\"x-file-name\":\"Detection\",\"x-line-number\":\"116\",\"x-component\":\"div\",\"x-id\":\"Detection_116\",\"x-dynamic\":\"true\",children:[/*#__PURE__*/_jsxs(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:0.6},className:\"text-center mb-12\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-4xl sm:text-5xl lg:text-6xl font-bold text-[#1E3A8A] mb-4\",\"x-file-name\":\"Detection\",\"x-line-number\":\"124\",\"x-component\":\"h1\",\"x-id\":\"Detection_124\",\"x-dynamic\":\"true\",children:t(\"detection.title\")}),/*#__PURE__*/_jsx(\"p\",{className:\"text-base sm:text-lg text-gray-600\",\"x-file-name\":\"Detection\",\"x-line-number\":\"127\",\"x-component\":\"p\",\"x-id\":\"Detection_127\",\"x-dynamic\":\"true\",children:t(\"detection.subtitle\")})]}),/*#__PURE__*/_jsx(motion.div,{initial:{opacity:0,scale:0.95},animate:{opacity:1,scale:1},transition:{duration:0.5},className:\"bg-white rounded-3xl p-8 md:p-12 shadow-2xl mb-8\",children:!preview?/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",\"x-file-name\":\"Detection\",\"x-line-number\":\"140\",\"x-component\":\"div\",\"x-id\":\"Detection_140\",\"x-dynamic\":\"false\",children:[/*#__PURE__*/_jsxs(\"div\",{\"data-testid\":\"upload-zone\",className:\"border-3 border-dashed border-[#2563EB] rounded-2xl p-12 text-center hover:bg-blue-50/50 transition-colors cursor-pointer\",onClick:()=>document.getElementById('file-input').click(),\"x-file-name\":\"Detection\",\"x-line-number\":\"141\",\"x-component\":\"div\",\"x-id\":\"Detection_141\",\"x-dynamic\":\"false\",children:[/*#__PURE__*/_jsx(\"div\",{\"x-file-name\":\"Detection\",\"x-line-number\":\"146\",\"x-component\":\"Upload\",\"x-id\":\"Detection_146\",\"x-dynamic\":\"false\",\"data-debug-wrapper\":\"true\",style:{display:\"contents\"},children:/*#__PURE__*/_jsx(Upload,{className:\"h-16 w-16 text-[#2563EB] mx-auto mb-4\"})}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-semibold text-[#1E3A8A] mb-2\",\"x-file-name\":\"Detection\",\"x-line-number\":\"147\",\"x-component\":\"h3\",\"x-id\":\"Detection_147\",\"x-dynamic\":\"true\",children:t(\"detection.clickToUpload\")}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500\",\"x-file-name\":\"Detection\",\"x-line-number\":\"150\",\"x-component\":\"p\",\"x-id\":\"Detection_150\",\"x-dynamic\":\"true\",children:t(\"detection.supportFormats\")})]}),/*#__PURE__*/_jsx(\"input\",{id:\"file-input\",\"data-testid\":\"file-input\",type:\"file\",accept:\"image/*\",onChange:handleFileSelect,className:\"hidden\",\"x-file-name\":\"Detection\",\"x-line-number\":\"155\",\"x-component\":\"input\",\"x-id\":\"Detection_155\",\"x-dynamic\":\"false\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",\"x-file-name\":\"Detection\",\"x-line-number\":\"164\",\"x-component\":\"div\",\"x-id\":\"Detection_164\",\"x-dynamic\":\"false\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500 mb-4\",\"x-file-name\":\"Detection\",\"x-line-number\":\"165\",\"x-component\":\"p\",\"x-id\":\"Detection_165\",\"x-dynamic\":\"true\",children:t(\"detection.orCapture\")}),/*#__PURE__*/_jsx(\"div\",{\"x-file-name\":\"Detection\",\"x-line-number\":\"166\",\"x-component\":\"Button\",\"x-id\":\"Detection_166\",\"x-dynamic\":\"true\",\"data-debug-wrapper\":\"true\",style:{display:\"contents\"},children:/*#__PURE__*/_jsxs(Button,{\"data-testid\":\"camera-btn\",variant:\"outline\",className:\"border-[#2563EB] text-[#2563EB] hover:bg-[#2563EB] hover:text-white\",onClick:()=>document.getElementById('file-input').click(),children:[/*#__PURE__*/_jsx(\"div\",{\"x-file-name\":\"Detection\",\"x-line-number\":\"172\",\"x-component\":\"Camera\",\"x-id\":\"Detection_172\",\"x-dynamic\":\"false\",\"data-debug-wrapper\":\"true\",style:{display:\"contents\"},children:/*#__PURE__*/_jsx(Camera,{className:\"mr-2 h-4 w-4\"})}),t(\"detection.useCamera\")]})})]})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",\"x-file-name\":\"Detection\",\"x-line-number\":\"178\",\"x-component\":\"div\",\"x-id\":\"Detection_178\",\"x-dynamic\":\"false\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"relative\",\"x-file-name\":\"Detection\",\"x-line-number\":\"180\",\"x-component\":\"div\",\"x-id\":\"Detection_180\",\"x-dynamic\":\"false\",children:/*#__PURE__*/_jsx(\"div\",{\"x-file-name\":\"Detection\",\"x-line-number\":\"181\",\"x-component\":\"ColorPicker\",\"x-id\":\"Detection_181\",\"x-dynamic\":\"true\",\"data-debug-wrapper\":\"true\",style:{display:\"contents\"},children:/*#__PURE__*/_jsx(ColorPicker,{imageSrc:preview,onColorSelect:handleColorSelect,selectedColor:manualColor,onReset:handleColorReset})})}),/*#__PURE__*/_jsx(\"div\",{className:\"text-center\",\"x-file-name\":\"Detection\",\"x-line-number\":\"190\",\"x-component\":\"div\",\"x-id\":\"Detection_190\",\"x-dynamic\":\"false\",children:/*#__PURE__*/_jsx(\"div\",{className:\"inline-flex items-center gap-2 px-4 py-2 rounded-full bg-gray-100 text-sm text-gray-600\",\"x-file-name\":\"Detection\",\"x-line-number\":\"191\",\"x-component\":\"div\",\"x-id\":\"Detection_191\",\"x-dynamic\":\"true\",children:useManualColor?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{\"x-file-name\":\"Detection\",\"x-line-number\":\"194\",\"x-component\":\"Palette\",\"x-id\":\"Detection_194\",\"x-dynamic\":\"false\",\"data-debug-wrapper\":\"true\",style:{display:\"contents\"},children:/*#__PURE__*/_jsx(Palette,{className:\"h-4 w-4\"})}),t(\"detection.usingManual\")]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{\"x-file-name\":\"Detection\",\"x-line-number\":\"199\",\"x-component\":\"Camera\",\"x-id\":\"Detection_199\",\"x-dynamic\":\"false\",\"data-debug-wrapper\":\"true\",style:{display:\"contents\"},children:/*#__PURE__*/_jsx(Camera,{className:\"h-4 w-4\"})}),t(\"detection.usingAuto\")]})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-4 justify-center\",\"x-file-name\":\"Detection\",\"x-line-number\":\"207\",\"x-component\":\"div\",\"x-id\":\"Detection_207\",\"x-dynamic\":\"false\",children:[/*#__PURE__*/_jsx(\"div\",{\"x-file-name\":\"Detection\",\"x-line-number\":\"208\",\"x-component\":\"Button\",\"x-id\":\"Detection_208\",\"x-dynamic\":\"true\",\"data-debug-wrapper\":\"true\",style:{display:\"contents\"},children:/*#__PURE__*/_jsx(Button,{\"data-testid\":\"change-image-btn\",variant:\"outline\",onClick:()=>{setSelectedFile(null);setPreview(null);setResult(null);setManualColor(null);setUseManualColor(false);},className:\"border-gray-300\",children:t(\"detection.changeImage\")})}),/*#__PURE__*/_jsx(\"div\",{\"x-file-name\":\"Detection\",\"x-line-number\":\"222\",\"x-component\":\"Button\",\"x-id\":\"Detection_222\",\"x-dynamic\":\"true\",\"data-debug-wrapper\":\"true\",style:{display:\"contents\"},children:/*#__PURE__*/_jsx(Button,{\"data-testid\":\"start-analysis-btn\",onClick:()=>{handleAnalysis();window.scrollTo({top:document.body.scrollHeight,behavior:\"smooth\"});},disabled:loading,className:\"bg-gradient-to-r from-[#1E3A8A] to-[#2563EB] hover:from-[#1e40af] hover:to-[#1d4ed8] text-white px-8\",children:loading?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{\"x-file-name\":\"Detection\",\"x-line-number\":\"233\",\"x-component\":\"Loader2\",\"x-id\":\"Detection_233\",\"x-dynamic\":\"false\",\"data-debug-wrapper\":\"true\",style:{display:\"contents\"},children:/*#__PURE__*/_jsx(Loader2,{className:\"mr-2 h-4 w-4 animate-spin\"})}),t(\"detection.analyzing\")]}):t(\"detection.startAnalysis\")})})]})]})}),loading&&/*#__PURE__*/_jsxs(motion.div,{initial:{opacity:0},animate:{opacity:1},className:\"bg-white rounded-3xl p-12 shadow-xl text-center\",children:[/*#__PURE__*/_jsx(\"div\",{\"x-file-name\":\"Detection\",\"x-line-number\":\"252\",\"x-component\":\"Loader2\",\"x-id\":\"Detection_252\",\"x-dynamic\":\"false\",\"data-debug-wrapper\":\"true\",style:{display:\"contents\"},children:/*#__PURE__*/_jsx(Loader2,{className:\"h-16 w-16 text-[#2563EB] mx-auto mb-4 animate-spin\"})}),/*#__PURE__*/_jsx(\"p\",{className:\"text-lg text-gray-600\",\"x-file-name\":\"Detection\",\"x-line-number\":\"253\",\"x-component\":\"p\",\"x-id\":\"Detection_253\",\"x-dynamic\":\"true\",children:t(\"detection.loadingText\")})]}),result&&!loading&&/*#__PURE__*/_jsxs(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:0.5},\"data-testid\":\"result-card\",className:\"bg-white rounded-3xl p-8 md:p-12 shadow-2xl\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-center mb-8\",\"x-file-name\":\"Detection\",\"x-line-number\":\"266\",\"x-component\":\"div\",\"x-id\":\"Detection_266\",\"x-dynamic\":\"false\",children:/*#__PURE__*/_jsx(\"h2\",{className:\"text-3xl font-bold text-[#1E3A8A] mb-2\",\"x-file-name\":\"Detection\",\"x-line-number\":\"267\",\"x-component\":\"h2\",\"x-id\":\"Detection_267\",\"x-dynamic\":\"false\",children:\"Analysis Results\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",\"x-file-name\":\"Detection\",\"x-line-number\":\"278\",\"x-component\":\"div\",\"x-id\":\"Detection_278\",\"x-dynamic\":\"true\",children:[/*#__PURE__*/_jsxs(\"div\",{\"x-file-name\":\"Detection\",\"x-line-number\":\"280\",\"x-component\":\"div\",\"x-id\":\"Detection_280\",\"x-dynamic\":\"false\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"text-sm font-medium text-gray-500 block mb-2\",\"x-file-name\":\"Detection\",\"x-line-number\":\"281\",\"x-component\":\"label\",\"x-id\":\"Detection_281\",\"x-dynamic\":\"true\",children:t(\"detection.labels.detectedMetal\")}),/*#__PURE__*/_jsx(\"div\",{\"data-testid\":\"metal-name\",className:\"text-2xl font-bold text-[#1E3A8A]\",\"x-file-name\":\"Detection\",\"x-line-number\":\"282\",\"x-component\":\"div\",\"x-id\":\"Detection_282\",\"x-dynamic\":\"true\",children:result.metal})]}),/*#__PURE__*/_jsxs(\"div\",{\"x-file-name\":\"Detection\",\"x-line-number\":\"291\",\"x-component\":\"div\",\"x-id\":\"Detection_291\",\"x-dynamic\":\"false\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"text-sm font-medium text-gray-500 block mb-2\",\"x-file-name\":\"Detection\",\"x-line-number\":\"292\",\"x-component\":\"label\",\"x-id\":\"Detection_292\",\"x-dynamic\":\"true\",children:t(\"detection.labels.concentration\")}),/*#__PURE__*/_jsx(\"div\",{\"data-testid\":\"concentration\",className:\"text-2xl font-bold text-[#2563EB]\",\"x-file-name\":\"Detection\",\"x-line-number\":\"293\",\"x-component\":\"div\",\"x-id\":\"Detection_293\",\"x-dynamic\":\"true\",children:result.concentration})]}),(result.confidence!==undefined||result.matchedType)&&/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-4\",\"x-file-name\":\"Detection\",\"x-line-number\":\"303\",\"x-component\":\"div\",\"x-id\":\"Detection_303\",\"x-dynamic\":\"true\",children:[result.confidence!==undefined&&/*#__PURE__*/_jsxs(\"div\",{\"x-file-name\":\"Detection\",\"x-line-number\":\"305\",\"x-component\":\"div\",\"x-id\":\"Detection_305\",\"x-dynamic\":\"false\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"text-sm font-medium text-gray-500 block mb-2\",\"x-file-name\":\"Detection\",\"x-line-number\":\"306\",\"x-component\":\"label\",\"x-id\":\"Detection_306\",\"x-dynamic\":\"false\",children:\"Confidence\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"inline-flex items-center gap-2 px-4 py-2 rounded-full text-sm font-semibold \".concat(getConfidenceColor(result.confidence*100)),\"x-file-name\":\"Detection\",\"x-line-number\":\"307\",\"x-component\":\"div\",\"x-id\":\"Detection_307\",\"x-dynamic\":\"true\",children:[getConfidenceIcon(result.confidence*100),(result.confidence*100).toFixed(0),\"%\"]})]}),result.matchedType&&/*#__PURE__*/_jsxs(\"div\",{\"x-file-name\":\"Detection\",\"x-line-number\":\"314\",\"x-component\":\"div\",\"x-id\":\"Detection_314\",\"x-dynamic\":\"false\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"text-sm font-medium text-gray-500 block mb-2\",\"x-file-name\":\"Detection\",\"x-line-number\":\"315\",\"x-component\":\"label\",\"x-id\":\"Detection_315\",\"x-dynamic\":\"false\",children:\"Match Type\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"inline-flex items-center gap-2 px-4 py-2 rounded-full text-sm font-semibold \".concat(result.matchedType===\"exact\"?\"text-green-600 bg-green-50\":\"text-yellow-600 bg-yellow-50\"),\"x-file-name\":\"Detection\",\"x-line-number\":\"316\",\"x-component\":\"div\",\"x-id\":\"Detection_316\",\"x-dynamic\":\"true\",children:[/*#__PURE__*/_jsx(\"div\",{\"x-file-name\":\"Detection\",\"x-line-number\":\"321\",\"x-component\":\"Info\",\"x-id\":\"Detection_321\",\"x-dynamic\":\"false\",\"data-debug-wrapper\":\"true\",style:{display:\"contents\"},children:/*#__PURE__*/_jsx(Info,{className:\"h-4 w-4\"})}),result.matchedType===\"exact\"?\"Exact Match\":\"Approximate Match\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{\"x-file-name\":\"Detection\",\"x-line-number\":\"330\",\"x-component\":\"div\",\"x-id\":\"Detection_330\",\"x-dynamic\":\"false\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"text-sm font-medium text-gray-500 block mb-2\",\"x-file-name\":\"Detection\",\"x-line-number\":\"331\",\"x-component\":\"label\",\"x-id\":\"Detection_331\",\"x-dynamic\":\"true\",children:t(\"detection.labels.status\")}),/*#__PURE__*/_jsxs(\"div\",{\"data-testid\":\"status\",className:\"inline-flex items-center gap-2 px-6 py-3 rounded-full text-lg font-semibold \".concat(getStatusColor(result.status)),\"x-file-name\":\"Detection\",\"x-line-number\":\"332\",\"x-component\":\"div\",\"x-id\":\"Detection_332\",\"x-dynamic\":\"true\",children:[getStatusIcon(result.status),result.status]})]}),/*#__PURE__*/_jsxs(\"div\",{\"x-file-name\":\"Detection\",\"x-line-number\":\"343\",\"x-component\":\"div\",\"x-id\":\"Detection_343\",\"x-dynamic\":\"false\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"text-sm font-medium text-gray-500 block mb-2\",\"x-file-name\":\"Detection\",\"x-line-number\":\"344\",\"x-component\":\"label\",\"x-id\":\"Detection_344\",\"x-dynamic\":\"true\",children:t(\"detection.labels.detectedColorRgb\")}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-4\",\"x-file-name\":\"Detection\",\"x-line-number\":\"345\",\"x-component\":\"div\",\"x-id\":\"Detection_345\",\"x-dynamic\":\"false\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-16 h-16 rounded-xl shadow-md\",style:{backgroundColor:\"rgb(\".concat(result.detected_rgb[0],\", \").concat(result.detected_rgb[1],\", \").concat(result.detected_rgb[2],\")\")},\"x-file-name\":\"Detection\",\"x-line-number\":\"346\",\"x-component\":\"div\",\"x-id\":\"Detection_346\",\"x-dynamic\":\"false\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-lg text-gray-700\",\"x-file-name\":\"Detection\",\"x-line-number\":\"352\",\"x-component\":\"span\",\"x-id\":\"Detection_352\",\"x-dynamic\":\"true\",children:[\"R: \",result.detected_rgb[0],\", G: \",result.detected_rgb[1],\", B: \",result.detected_rgb[2]]})]})]})]})]})]})});}","map":{"version":3,"names":["useState","motion","Upload","Camera","Loader2","AlertCircle","CheckCircle2","Palette","TrendingUp","Info","Button","ColorPicker","axios","toast","useTranslation","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","BACKEND_URL","API","concat","Detection","selectedFile","setSelectedFile","preview","setPreview","loading","setLoading","result","setResult","manualColor","setManualColor","useManualColor","setUseManualColor","t","handleFileSelect","e","file","target","files","reader","FileReader","onloadend","readAsDataURL","handleAnalysis","error","formData","FormData","append","console","log","JSON","stringify","response","post","headers","withCredentials","data","success","_error$response","_error$response$data","detail","handleColorSelect","color","handleColorReset","getStatusColor","status","includes","getStatusIcon","style","display","children","className","getConfidenceColor","score","getConfidenceIcon","div","initial","opacity","y","animate","transition","duration","scale","onClick","document","getElementById","click","id","type","accept","onChange","variant","imageSrc","onColorSelect","selectedColor","onReset","window","scrollTo","top","body","scrollHeight","behavior","disabled","metal","concentration","confidence","undefined","matchedType","toFixed","backgroundColor","detected_rgb"],"sources":["C:/Users/ADMIN/Desktop/Pharma/Frontend/src/pages/Detection.jsx"],"sourcesContent":["import { useState } from \"react\";\r\nimport { motion } from \"framer-motion\";\r\nimport { Upload, Camera, Loader2, AlertCircle, CheckCircle2, Palette, TrendingUp, Info } from \"lucide-react\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport ColorPicker from \"@/components/ColorPicker\";\r\nimport axios from \"axios\";\r\nimport { toast } from \"sonner\";\r\nimport { useTranslation } from \"react-i18next\";\r\n\r\n// const BACKEND_URL ='https://pharmacy-project-lh5x.onrender.com';\r\nconst BACKEND_URL = 'https://pharmacy-project-lzv7.onrender.com';\r\nconst API = `${BACKEND_URL}/api`;\r\n\r\nexport default function Detection() {\r\n  const [selectedFile, setSelectedFile] = useState(null);\r\n  const [preview, setPreview] = useState(null);\r\n  const [loading, setLoading] = useState(false);\r\n  const [result, setResult] = useState(null);\r\n  const [manualColor, setManualColor] = useState(null);\r\n  const [useManualColor, setUseManualColor] = useState(false);\r\n  const { t } = useTranslation();\r\n\r\n  const handleFileSelect = (e) => {\r\n    const file = e.target.files[0];\r\n    if (file) {\r\n      setSelectedFile(file);\r\n      setResult(null);\r\n      setManualColor(null);\r\n      setUseManualColor(false);\r\n      \r\n      // Create preview\r\n      const reader = new FileReader();\r\n      reader.onloadend = () => {\r\n        setPreview(reader.result);\r\n      };\r\n      reader.readAsDataURL(file);\r\n    }\r\n  };\r\n\r\n  const handleAnalysis = async () => {\r\n    if (!selectedFile) {\r\n      toast.error(t(\"detection.clickToUpload\"));\r\n      return;\r\n    }\r\n\r\n    setLoading(true);\r\n    setResult(null);\r\n\r\n    try {\r\n      const formData = new FormData();\r\n      formData.append(\"file\", selectedFile);\r\n      \r\n      // Add manual color if user selected one\r\n      if (useManualColor && manualColor) {\r\n        console.log(\"ðŸŽ¨ Sending manual color:\", manualColor);\r\n        formData.append(\"manual_color\", JSON.stringify(manualColor));\r\n      } else {\r\n        console.log(\"ðŸ”„ Using automatic detection\");\r\n      }\r\n\r\n      console.log(`ðŸŒ Sending request to: ${API}/analyze`);\r\n      const response = await axios.post(`${API}/analyze`, formData, {\r\n        headers: {\r\n          \"Content-Type\": \"multipart/form-data\"\r\n        },\r\n        withCredentials: false, // Don't send credentials for CORS\r\n      });\r\n\r\n      console.log(\"âœ… API Response:\", response.data);\r\n      setResult(response.data);\r\n      toast.success(t(\"detection.analysisResults\"));\r\n    } catch (error) {\r\n      console.error(\"Analysis error:\", error);\r\n      toast.error(error.response?.data?.detail || t(\"detection.loadingText\"));\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleColorSelect = (color) => {\r\n    setManualColor(color);\r\n    setUseManualColor(true);\r\n  };\r\n\r\n  const handleColorReset = () => {\r\n    setManualColor(null);\r\n    setUseManualColor(false);\r\n  };\r\n\r\n  const getStatusColor = (status) => {\r\n    if (status === \"Safe\") return \"text-green-600 bg-green-50\";\r\n    if (status.includes(\"Slight\")) return \"text-yellow-600 bg-yellow-50\";\r\n    if (status === \"Contaminated\") return \"text-orange-600 bg-orange-50\";\r\n    return \"text-red-600 bg-red-50\";\r\n  };\r\n\r\n  const getStatusIcon = (status) => {\r\n    if (status === \"Safe\") return <CheckCircle2 className=\"h-6 w-6\" />;\r\n    return <AlertCircle className=\"h-6 w-6\" />;\r\n  };\r\n\r\n  const getConfidenceColor = (score) => {\r\n    if (score >= 80) return \"text-green-600 bg-green-50\";\r\n    if (score >= 60) return \"text-yellow-600 bg-yellow-50\";\r\n    return \"text-red-600 bg-red-50\";\r\n  };\r\n\r\n  const getConfidenceIcon = (score) => {\r\n    if (score >= 80) return <TrendingUp className=\"h-4 w-4\" />;\r\n    if (score >= 60) return <AlertCircle className=\"h-4 w-4\" />;\r\n    return <AlertCircle className=\"h-4 w-4\" />;\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen py-20 px-4\">\r\n      <div className=\"max-w-4xl mx-auto\">\r\n        {/* Header */}\r\n        <motion.div\r\n          initial={{ opacity: 0, y: 20 }}\r\n          animate={{ opacity: 1, y: 0 }}\r\n          transition={{ duration: 0.6 }}\r\n          className=\"text-center mb-12\"\r\n        >\r\n          <h1 className=\"text-4xl sm:text-5xl lg:text-6xl font-bold text-[#1E3A8A] mb-4\">\r\n            {t(\"detection.title\")}\r\n          </h1>\r\n          <p className=\"text-base sm:text-lg text-gray-600\">\r\n            {t(\"detection.subtitle\")}\r\n          </p>\r\n        </motion.div>\r\n\r\n        {/* Upload Card */}\r\n        <motion.div\r\n          initial={{ opacity: 0, scale: 0.95 }}\r\n          animate={{ opacity: 1, scale: 1 }}\r\n          transition={{ duration: 0.5 }}\r\n          className=\"bg-white rounded-3xl p-8 md:p-12 shadow-2xl mb-8\"\r\n        >\r\n          {!preview ? (\r\n            <div className=\"space-y-6\">\r\n              <div\r\n                data-testid=\"upload-zone\"\r\n                className=\"border-3 border-dashed border-[#2563EB] rounded-2xl p-12 text-center hover:bg-blue-50/50 transition-colors cursor-pointer\"\r\n                onClick={() => document.getElementById('file-input').click()}\r\n              >\r\n                <Upload className=\"h-16 w-16 text-[#2563EB] mx-auto mb-4\" />\r\n                <h3 className=\"text-xl font-semibold text-[#1E3A8A] mb-2\">\r\n                  {t(\"detection.clickToUpload\")}\r\n                </h3>\r\n                <p className=\"text-sm text-gray-500\">\r\n                  {t(\"detection.supportFormats\")}\r\n                </p>\r\n              </div>\r\n\r\n              <input\r\n                id=\"file-input\"\r\n                data-testid=\"file-input\"\r\n                type=\"file\"\r\n                accept=\"image/*\"\r\n                onChange={handleFileSelect}\r\n                className=\"hidden\"\r\n              />\r\n\r\n              <div className=\"text-center\">\r\n                <p className=\"text-sm text-gray-500 mb-4\">{t(\"detection.orCapture\")}</p>\r\n                <Button\r\n                  data-testid=\"camera-btn\"\r\n                  variant=\"outline\"\r\n                  className=\"border-[#2563EB] text-[#2563EB] hover:bg-[#2563EB] hover:text-white\"\r\n                  onClick={() => document.getElementById('file-input').click()}\r\n                >\r\n                  <Camera className=\"mr-2 h-4 w-4\" />\r\n                  {t(\"detection.useCamera\")}\r\n                </Button>\r\n              </div>\r\n            </div>\r\n          ) : (\r\n            <div className=\"space-y-6\">\r\n              {/* Preview with Color Picker */}\r\n              <div className=\"relative\">\r\n                <ColorPicker\r\n                  imageSrc={preview}\r\n                  onColorSelect={handleColorSelect}\r\n                  selectedColor={manualColor}\r\n                  onReset={handleColorReset}\r\n                />\r\n              </div>\r\n\r\n              {/* Detection Method Indicator */}\r\n              <div className=\"text-center\">\r\n                <div className=\"inline-flex items-center gap-2 px-4 py-2 rounded-full bg-gray-100 text-sm text-gray-600\">\r\n                  {useManualColor ? (\r\n                    <>\r\n                      <Palette className=\"h-4 w-4\" />\r\n                      {t(\"detection.usingManual\")}\r\n                    </>\r\n                  ) : (\r\n                    <>\r\n                      <Camera className=\"h-4 w-4\" />\r\n                      {t(\"detection.usingAuto\")}\r\n                    </>\r\n                  )}\r\n                </div>\r\n              </div>\r\n\r\n              {/* Actions */}\r\n              <div className=\"flex gap-4 justify-center\">\r\n                <Button\r\n                  data-testid=\"change-image-btn\"\r\n                  variant=\"outline\"\r\n                  onClick={() => {\r\n                    setSelectedFile(null);\r\n                    setPreview(null);\r\n                    setResult(null);\r\n                    setManualColor(null);\r\n                    setUseManualColor(false);\r\n                  }}\r\n                  className=\"border-gray-300\"\r\n                >\r\n                  {t(\"detection.changeImage\")}\r\n                </Button>\r\n                <Button\r\n                  data-testid=\"start-analysis-btn\"\r\n                  onClick={()=>{\r\n                    handleAnalysis();\r\n                     window.scrollTo({ top: document.body.scrollHeight, behavior: \"smooth\" });\r\n                    }}\r\n                  disabled={loading}\r\n                  className=\"bg-gradient-to-r from-[#1E3A8A] to-[#2563EB] hover:from-[#1e40af] hover:to-[#1d4ed8] text-white px-8\"\r\n                >\r\n                  {loading ? (\r\n                    <>\r\n                      <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\r\n                      {t(\"detection.analyzing\")}\r\n                    </>\r\n                  ) : (\r\n                    t(\"detection.startAnalysis\")\r\n                  )}\r\n                </Button>\r\n              </div>\r\n            </div>\r\n          )}\r\n        </motion.div>\r\n\r\n        {/* Loading State */}\r\n        {loading && (\r\n          <motion.div\r\n            initial={{ opacity: 0 }}\r\n            animate={{ opacity: 1 }}\r\n            className=\"bg-white rounded-3xl p-12 shadow-xl text-center\"\r\n          >\r\n            <Loader2 className=\"h-16 w-16 text-[#2563EB] mx-auto mb-4 animate-spin\" />\r\n            <p className=\"text-lg text-gray-600\">{t(\"detection.loadingText\")}</p>\r\n          </motion.div>\r\n        )}\r\n\r\n        {/* Result Card */}\r\n        {result && !loading && (\r\n          <motion.div\r\n            initial={{ opacity: 0, y: 20 }}\r\n            animate={{ opacity: 1, y: 0 }}\r\n            transition={{ duration: 0.5 }}\r\n            data-testid=\"result-card\"\r\n            className=\"bg-white rounded-3xl p-8 md:p-12 shadow-2xl\"\r\n          >\r\n            <div className=\"text-center mb-8\">\r\n              <h2 className=\"text-3xl font-bold text-[#1E3A8A] mb-2\">\r\n                Analysis Results\r\n              </h2>\r\n              {/* AI-Powered Safety Recommendations badge - commented out\r\n              <div className=\"inline-flex items-center gap-2 px-4 py-2 rounded-full bg-gradient-to-r from-blue-50 to-purple-50 text-sm text-[#1E3A8A]\">\r\n                <Brain className=\"h-4 w-4\" />\r\n                {t(\"detection.aiBadge\")}\r\n              </div>\r\n              */}\r\n            </div>\r\n\r\n            <div className=\"space-y-6\">\r\n              {/* Metal Name */}\r\n              <div>\r\n                <label className=\"text-sm font-medium text-gray-500 block mb-2\">{t(\"detection.labels.detectedMetal\")}</label>\r\n                <div\r\n                  data-testid=\"metal-name\"\r\n                  className=\"text-2xl font-bold text-[#1E3A8A]\"\r\n                >\r\n                  {result.metal}\r\n                </div>\r\n              </div>\r\n\r\n              {/* Concentration */}\r\n              <div>\r\n                <label className=\"text-sm font-medium text-gray-500 block mb-2\">{t(\"detection.labels.concentration\")}</label>\r\n                <div\r\n                  data-testid=\"concentration\"\r\n                  className=\"text-2xl font-bold text-[#2563EB]\"\r\n                >\r\n                  {result.concentration}\r\n                </div>\r\n              </div>\r\n\r\n              {/* Confidence & Match Type (if available) */}\r\n              {(result.confidence !== undefined || result.matchedType) && (\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                  {result.confidence !== undefined && (\r\n                    <div>\r\n                      <label className=\"text-sm font-medium text-gray-500 block mb-2\">Confidence</label>\r\n                      <div className={`inline-flex items-center gap-2 px-4 py-2 rounded-full text-sm font-semibold ${getConfidenceColor(result.confidence * 100)}`}>\r\n                        {getConfidenceIcon(result.confidence * 100)}\r\n                        {(result.confidence * 100).toFixed(0)}%\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n                  {result.matchedType && (\r\n                    <div>\r\n                      <label className=\"text-sm font-medium text-gray-500 block mb-2\">Match Type</label>\r\n                      <div className={`inline-flex items-center gap-2 px-4 py-2 rounded-full text-sm font-semibold ${\r\n                        result.matchedType === \"exact\" \r\n                          ? \"text-green-600 bg-green-50\" \r\n                          : \"text-yellow-600 bg-yellow-50\"\r\n                      }`}>\r\n                        <Info className=\"h-4 w-4\" />\r\n                        {result.matchedType === \"exact\" ? \"Exact Match\" : \"Approximate Match\"}\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              )}\r\n\r\n              {/* Status */}\r\n              <div>\r\n                <label className=\"text-sm font-medium text-gray-500 block mb-2\">{t(\"detection.labels.status\")}</label>\r\n                <div\r\n                  data-testid=\"status\"\r\n                  className={`inline-flex items-center gap-2 px-6 py-3 rounded-full text-lg font-semibold ${getStatusColor(result.status)}`}\r\n                >\r\n                  {getStatusIcon(result.status)}\r\n                  {result.status}\r\n                </div>\r\n              </div>\r\n\r\n\r\n              {/* Detected Color */}\r\n              <div>\r\n                <label className=\"text-sm font-medium text-gray-500 block mb-2\">{t(\"detection.labels.detectedColorRgb\")}</label>\r\n                <div className=\"flex items-center gap-4\">\r\n                  <div\r\n                    className=\"w-16 h-16 rounded-xl shadow-md\"\r\n                    style={{\r\n                      backgroundColor: `rgb(${result.detected_rgb[0]}, ${result.detected_rgb[1]}, ${result.detected_rgb[2]})`\r\n                    }}\r\n                  />\r\n                  <span className=\"text-lg text-gray-700\">\r\n                    R: {result.detected_rgb[0]}, G: {result.detected_rgb[1]}, B: {result.detected_rgb[2]}\r\n                  </span>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Basic Recommendation */}\r\n              {/* <div className=\"bg-blue-50 rounded-2xl p-6\">\r\n                <label className=\"text-sm font-medium text-[#1E3A8A] block mb-2\">\r\n                  Basic Recommendation\r\n                </label>\r\n                <p\r\n                  data-testid=\"recommendation\"\r\n                  className=\"text-base text-gray-700\"\r\n                >\r\n                  {result.recommendation}\r\n                </p>\r\n              </div> */}\r\n\r\n              {/* AI-Powered Recommendations and Precautions - commented out for now */}\r\n              {/* {result.ai_recommendations && Object.keys(result.ai_recommendations).length > 0 && (\r\n                <div className=\"space-y-6\">\r\n                  <div className=\"text-center\">\r\n                    <div className=\"inline-flex items-center gap-2 px-4 py-2 rounded-full bg-gradient-to-r from-purple-50 to-blue-50 text-sm text-[#1E3A8A] mb-4\">\r\n                      <Brain className=\"h-4 w-4\" />\r\n                      AI-Powered Safety Recommendations\r\n                    </div>\r\n                  </div>\r\n\r\n                  {result.ai_recommendations.immediate_actions && (\r\n                    <div className=\"bg-red-50 rounded-2xl p-6\">\r\n                      <div className=\"flex items-center gap-2 mb-3\">\r\n                        <AlertCircle className=\"h-5 w-5 text-red-600\" />\r\n                        <label className=\"text-sm font-medium text-red-800\">{t(\"detection.labels.immediateActions\")}</label>\r\n                      </div>\r\n                      <ul className=\"space-y-2\">\r\n                        {result.ai_recommendations.immediate_actions.map((action, index) => (\r\n                          <li key={index} className=\"text-sm text-gray-700 flex items-start gap-2\">\r\n                            <span className=\"text-red-500 mt-1\">â€¢</span>\r\n                            {action}\r\n                          </li>\r\n                        ))}\r\n                      </ul>\r\n                    </div>\r\n                  )}\r\n\r\n                  {result.ai_recommendations.treatment_options && (\r\n                    <div className=\"bg-green-50 rounded-2xl p-6\">\r\n                      <div className=\"flex items-center gap-2 mb-3\">\r\n                        <Shield className=\"h-5 w-5 text-green-600\" />\r\n                        <label className=\"text-sm font-medium text-green-800\">{t(\"detection.labels.treatmentOptions\")}</label>\r\n                      </div>\r\n                      <ul className=\"space-y-2\">\r\n                        {result.ai_recommendations.treatment_options.map((option, index) => (\r\n                          <li key={index} className=\"text-sm text-gray-700 flex items-start gap-2\">\r\n                            <span className=\"text-green-500 mt-1\">â€¢</span>\r\n                            {option}\r\n                          </li>\r\n                        ))}\r\n                      </ul>\r\n                    </div>\r\n                  )}\r\n\r\n                  {result.ai_recommendations.health_risks && (\r\n                    <div className=\"bg-orange-50 rounded-2xl p-6\">\r\n                      <div className=\"flex items-center gap-2 mb-3\">\r\n                        <AlertCircle className=\"h-5 w-5 text-orange-600\" />\r\n                        <label className=\"text-sm font-medium text-orange-800\">{t(\"detection.labels.healthConsiderations\")}</label>\r\n                      </div>\r\n                      <p className=\"text-sm text-gray-700\">\r\n                        {result.ai_recommendations.health_risks}\r\n                      </p>\r\n                    </div>\r\n                  )}\r\n\r\n                  {result.ai_recommendations.prevention_tips && (\r\n                    <div className=\"bg-blue-50 rounded-2xl p-6\">\r\n                      <div className=\"flex items-center gap-2 mb-3\">\r\n                        <Lightbulb className=\"h-5 w-5 text-blue-600\" />\r\n                        <label className=\"text-sm font-medium text-blue-800\">{t(\"detection.labels.preventionTips\")}</label>\r\n                      </div>\r\n                      <ul className=\"space-y-2\">\r\n                        {result.ai_recommendations.prevention_tips.map((tip, index) => (\r\n                          <li key={index} className=\"text-sm text-gray-700 flex items-start gap-2\">\r\n                            <span className=\"text-blue-500 mt-1\">â€¢</span>\r\n                            {tip}\r\n                          </li>\r\n                        ))}\r\n                      </ul>\r\n                    </div>\r\n                  )}\r\n\r\n                  {result.ai_recommendations.professional_help && (\r\n                    <div className=\"bg-purple-50 rounded-2xl p-6\">\r\n                      <div className=\"flex items-center gap-2 mb-3\">\r\n                        <TrendingUp className=\"h-5 w-5 text-purple-600\" />\r\n                        <label className=\"text-sm font-medium text-purple-800\">{t(\"detection.labels.professionalHelp\")}</label>\r\n                      </div>\r\n                      <p className=\"text-sm text-gray-700\">\r\n                        {result.ai_recommendations.professional_help}\r\n                      </p>\r\n                    </div>\r\n                  )}\r\n\r\n                  {result.ai_recommendations.additional_precautions && (\r\n                    <div className=\"bg-yellow-50 rounded-2xl p-6\">\r\n                      <div className=\"flex items-center gap-2 mb-3\">\r\n                        <Shield className=\"h-5 w-5 text-yellow-600\" />\r\n                        <label className=\"text-sm font-medium text-yellow-800\">{t(\"detection.labels.additionalPrecautions\")}</label>\r\n                      </div>\r\n                      <p className=\"text-sm text-gray-700\">\r\n                        {result.ai_recommendations.additional_precautions}\r\n                      </p>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              )} */}\r\n            </div>\r\n          </motion.div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}"],"mappings":"AAAA,OAASA,QAAQ,KAAQ,OAAO,CAChC,OAASC,MAAM,KAAQ,eAAe,CACtC,OAASC,MAAM,CAAEC,MAAM,CAAEC,OAAO,CAAEC,WAAW,CAAEC,YAAY,CAAEC,OAAO,CAAEC,UAAU,CAAEC,IAAI,KAAQ,cAAc,CAC5G,OAASC,MAAM,KAAQ,wBAAwB,CAC/C,MAAO,CAAAC,WAAW,KAAM,0BAA0B,CAClD,MAAO,CAAAC,KAAK,KAAM,OAAO,CACzB,OAASC,KAAK,KAAQ,QAAQ,CAC9B,OAASC,cAAc,KAAQ,eAAe,CAE9C;AAAA,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,CAAAC,QAAA,IAAAC,SAAA,yBACA,KAAM,CAAAC,WAAW,CAAG,4CAA4C,CAChE,KAAM,CAAAC,GAAG,IAAAC,MAAA,CAAMF,WAAW,QAAM,CAEhC,cAAe,SAAS,CAAAG,SAASA,CAAA,CAAG,CAClC,KAAM,CAACC,YAAY,CAAEC,eAAe,CAAC,CAAG1B,QAAQ,CAAC,IAAI,CAAC,CACtD,KAAM,CAAC2B,OAAO,CAAEC,UAAU,CAAC,CAAG5B,QAAQ,CAAC,IAAI,CAAC,CAC5C,KAAM,CAAC6B,OAAO,CAAEC,UAAU,CAAC,CAAG9B,QAAQ,CAAC,KAAK,CAAC,CAC7C,KAAM,CAAC+B,MAAM,CAAEC,SAAS,CAAC,CAAGhC,QAAQ,CAAC,IAAI,CAAC,CAC1C,KAAM,CAACiC,WAAW,CAAEC,cAAc,CAAC,CAAGlC,QAAQ,CAAC,IAAI,CAAC,CACpD,KAAM,CAACmC,cAAc,CAAEC,iBAAiB,CAAC,CAAGpC,QAAQ,CAAC,KAAK,CAAC,CAC3D,KAAM,CAAEqC,CAAE,CAAC,CAAGvB,cAAc,CAAC,CAAC,CAE9B,KAAM,CAAAwB,gBAAgB,CAAIC,CAAC,EAAK,CAC9B,KAAM,CAAAC,IAAI,CAAGD,CAAC,CAACE,MAAM,CAACC,KAAK,CAAC,CAAC,CAAC,CAC9B,GAAIF,IAAI,CAAE,CACRd,eAAe,CAACc,IAAI,CAAC,CACrBR,SAAS,CAAC,IAAI,CAAC,CACfE,cAAc,CAAC,IAAI,CAAC,CACpBE,iBAAiB,CAAC,KAAK,CAAC,CAExB;AACA,KAAM,CAAAO,MAAM,CAAG,GAAI,CAAAC,UAAU,CAAC,CAAC,CAC/BD,MAAM,CAACE,SAAS,CAAG,IAAM,CACvBjB,UAAU,CAACe,MAAM,CAACZ,MAAM,CAAC,CAC3B,CAAC,CACDY,MAAM,CAACG,aAAa,CAACN,IAAI,CAAC,CAC5B,CACF,CAAC,CAED,KAAM,CAAAO,cAAc,CAAG,KAAAA,CAAA,GAAY,CACjC,GAAI,CAACtB,YAAY,CAAE,CACjBZ,KAAK,CAACmC,KAAK,CAACX,CAAC,CAAC,yBAAyB,CAAC,CAAC,CACzC,OACF,CAEAP,UAAU,CAAC,IAAI,CAAC,CAChBE,SAAS,CAAC,IAAI,CAAC,CAEf,GAAI,CACF,KAAM,CAAAiB,QAAQ,CAAG,GAAI,CAAAC,QAAQ,CAAC,CAAC,CAC/BD,QAAQ,CAACE,MAAM,CAAC,MAAM,CAAE1B,YAAY,CAAC,CAErC;AACA,GAAIU,cAAc,EAAIF,WAAW,CAAE,CACjCmB,OAAO,CAACC,GAAG,CAAC,0BAA0B,CAAEpB,WAAW,CAAC,CACpDgB,QAAQ,CAACE,MAAM,CAAC,cAAc,CAAEG,IAAI,CAACC,SAAS,CAACtB,WAAW,CAAC,CAAC,CAC9D,CAAC,IAAM,CACLmB,OAAO,CAACC,GAAG,CAAC,8BAA8B,CAAC,CAC7C,CAEAD,OAAO,CAACC,GAAG,qCAAA9B,MAAA,CAA2BD,GAAG,YAAU,CAAC,CACpD,KAAM,CAAAkC,QAAQ,CAAG,KAAM,CAAA5C,KAAK,CAAC6C,IAAI,IAAAlC,MAAA,CAAID,GAAG,aAAY2B,QAAQ,CAAE,CAC5DS,OAAO,CAAE,CACP,cAAc,CAAE,qBAClB,CAAC,CACDC,eAAe,CAAE,KAAO;AAC1B,CAAC,CAAC,CAEFP,OAAO,CAACC,GAAG,CAAC,iBAAiB,CAAEG,QAAQ,CAACI,IAAI,CAAC,CAC7C5B,SAAS,CAACwB,QAAQ,CAACI,IAAI,CAAC,CACxB/C,KAAK,CAACgD,OAAO,CAACxB,CAAC,CAAC,2BAA2B,CAAC,CAAC,CAC/C,CAAE,MAAOW,KAAK,CAAE,KAAAc,eAAA,CAAAC,oBAAA,CACdX,OAAO,CAACJ,KAAK,CAAC,iBAAiB,CAAEA,KAAK,CAAC,CACvCnC,KAAK,CAACmC,KAAK,CAAC,EAAAc,eAAA,CAAAd,KAAK,CAACQ,QAAQ,UAAAM,eAAA,kBAAAC,oBAAA,CAAdD,eAAA,CAAgBF,IAAI,UAAAG,oBAAA,iBAApBA,oBAAA,CAAsBC,MAAM,GAAI3B,CAAC,CAAC,uBAAuB,CAAC,CAAC,CACzE,CAAC,OAAS,CACRP,UAAU,CAAC,KAAK,CAAC,CACnB,CACF,CAAC,CAED,KAAM,CAAAmC,iBAAiB,CAAIC,KAAK,EAAK,CACnChC,cAAc,CAACgC,KAAK,CAAC,CACrB9B,iBAAiB,CAAC,IAAI,CAAC,CACzB,CAAC,CAED,KAAM,CAAA+B,gBAAgB,CAAGA,CAAA,GAAM,CAC7BjC,cAAc,CAAC,IAAI,CAAC,CACpBE,iBAAiB,CAAC,KAAK,CAAC,CAC1B,CAAC,CAED,KAAM,CAAAgC,cAAc,CAAIC,MAAM,EAAK,CACjC,GAAIA,MAAM,GAAK,MAAM,CAAE,MAAO,4BAA4B,CAC1D,GAAIA,MAAM,CAACC,QAAQ,CAAC,QAAQ,CAAC,CAAE,MAAO,8BAA8B,CACpE,GAAID,MAAM,GAAK,cAAc,CAAE,MAAO,8BAA8B,CACpE,MAAO,wBAAwB,CACjC,CAAC,CAED,KAAM,CAAAE,aAAa,CAAIF,MAAM,EAAK,CAChC,GAAIA,MAAM,GAAK,MAAM,CAAE,mBAAArD,IAAA,0JAAAwD,KAAA,EAAAC,OAAA,aAAAC,QAAA,cAAO1D,IAAA,CAACV,YAAY,EAACqE,SAAS,CAAC,SAAS,CAAE,CAAC,GAClE,mBAAA3D,IAAA,yJAAAwD,KAAA,EAAAC,OAAA,aAAAC,QAAA,cAAO1D,IAAA,CAACX,WAAW,EAACsE,SAAS,CAAC,SAAS,CAAE,CAAC,GAC5C,CAAC,CAED,KAAM,CAAAC,kBAAkB,CAAIC,KAAK,EAAK,CACpC,GAAIA,KAAK,EAAI,EAAE,CAAE,MAAO,4BAA4B,CACpD,GAAIA,KAAK,EAAI,EAAE,CAAE,MAAO,8BAA8B,CACtD,MAAO,wBAAwB,CACjC,CAAC,CAED,KAAM,CAAAC,iBAAiB,CAAID,KAAK,EAAK,CACnC,GAAIA,KAAK,EAAI,EAAE,CAAE,mBAAA7D,IAAA,0JAAAwD,KAAA,EAAAC,OAAA,aAAAC,QAAA,cAAO1D,IAAA,CAACR,UAAU,EAACmE,SAAS,CAAC,SAAS,CAAE,CAAC,GAC1D,GAAIE,KAAK,EAAI,EAAE,CAAE,mBAAA7D,IAAA,2JAAAwD,KAAA,EAAAC,OAAA,aAAAC,QAAA,cAAO1D,IAAA,CAACX,WAAW,EAACsE,SAAS,CAAC,SAAS,CAAE,CAAC,GAC3D,mBAAA3D,IAAA,2JAAAwD,KAAA,EAAAC,OAAA,aAAAC,QAAA,cAAO1D,IAAA,CAACX,WAAW,EAACsE,SAAS,CAAC,SAAS,CAAE,CAAC,GAC5C,CAAC,CAED,mBACE3D,IAAA,QAAK2D,SAAS,CAAC,yBAAyB,gHAAAD,QAAA,cACtCxD,KAAA,QAAKyD,SAAS,CAAC,mBAAmB,+GAAAD,QAAA,eAEhCxD,KAAA,CAACjB,MAAM,CAAC8E,GAAG,EACTC,OAAO,CAAE,CAAEC,OAAO,CAAE,CAAC,CAAEC,CAAC,CAAE,EAAG,CAAE,CAC/BC,OAAO,CAAE,CAAEF,OAAO,CAAE,CAAC,CAAEC,CAAC,CAAE,CAAE,CAAE,CAC9BE,UAAU,CAAE,CAAEC,QAAQ,CAAE,GAAI,CAAE,CAC9BV,SAAS,CAAC,mBAAmB,CAAAD,QAAA,eAE7B1D,IAAA,OAAI2D,SAAS,CAAC,gEAAgE,8GAAAD,QAAA,CAC3ErC,CAAC,CAAC,iBAAiB,CAAC,CACnB,CAAC,cACLrB,IAAA,MAAG2D,SAAS,CAAC,oCAAoC,6GAAAD,QAAA,CAC9CrC,CAAC,CAAC,oBAAoB,CAAC,CACvB,CAAC,EACM,CAAC,cAGbrB,IAAA,CAACf,MAAM,CAAC8E,GAAG,EACTC,OAAO,CAAE,CAAEC,OAAO,CAAE,CAAC,CAAEK,KAAK,CAAE,IAAK,CAAE,CACrCH,OAAO,CAAE,CAAEF,OAAO,CAAE,CAAC,CAAEK,KAAK,CAAE,CAAE,CAAE,CAClCF,UAAU,CAAE,CAAEC,QAAQ,CAAE,GAAI,CAAE,CAC9BV,SAAS,CAAC,kDAAkD,CAAAD,QAAA,CAE3D,CAAC/C,OAAO,cACPT,KAAA,QAAKyD,SAAS,CAAC,WAAW,gHAAAD,QAAA,eACxBxD,KAAA,QACE,cAAY,aAAa,CACzByD,SAAS,CAAC,2HAA2H,CACrIY,OAAO,CAAEA,CAAA,GAAMC,QAAQ,CAACC,cAAc,CAAC,YAAY,CAAC,CAACC,KAAK,CAAC,CAAE,gHAAAhB,QAAA,eAAA1D,IAAA,sJAAAwD,KAAA,EAAAC,OAAA,aAAAC,QAAA,cAE7D1D,IAAA,CAACd,MAAM,EAACyE,SAAS,CAAC,uCAAuC,CAAE,CAAC,gBAC5D3D,IAAA,OAAI2D,SAAS,CAAC,2CAA2C,8GAAAD,QAAA,CACtDrC,CAAC,CAAC,yBAAyB,CAAC,CAC3B,CAAC,cACLrB,IAAA,MAAG2D,SAAS,CAAC,uBAAuB,6GAAAD,QAAA,CACjCrC,CAAC,CAAC,0BAA0B,CAAC,CAC7B,CAAC,EACD,CAAC,cAENrB,IAAA,UACE2E,EAAE,CAAC,YAAY,CACf,cAAY,YAAY,CACxBC,IAAI,CAAC,MAAM,CACXC,MAAM,CAAC,SAAS,CAChBC,QAAQ,CAAExD,gBAAiB,CAC3BqC,SAAS,CAAC,QAAQ,kHACnB,CAAC,cAEFzD,KAAA,QAAKyD,SAAS,CAAC,aAAa,gHAAAD,QAAA,eAC1B1D,IAAA,MAAG2D,SAAS,CAAC,4BAA4B,6GAAAD,QAAA,CAAErC,CAAC,CAAC,qBAAqB,CAAC,CAAI,CAAC,cAAArB,IAAA,qJAAAwD,KAAA,EAAAC,OAAA,aAAAC,QAAA,cACxExD,KAAA,CAACR,MAAM,EACL,cAAY,YAAY,CACxBqF,OAAO,CAAC,SAAS,CACjBpB,SAAS,CAAC,qEAAqE,CAC/EY,OAAO,CAAEA,CAAA,GAAMC,QAAQ,CAACC,cAAc,CAAC,YAAY,CAAC,CAACC,KAAK,CAAC,CAAE,CAAAhB,QAAA,eAAA1D,IAAA,sJAAAwD,KAAA,EAAAC,OAAA,aAAAC,QAAA,cAE7D1D,IAAA,CAACb,MAAM,EAACwE,SAAS,CAAC,cAAc,CAAE,CAAC,GAClCtC,CAAC,CAAC,qBAAqB,CAAC,EACnB,CAAC,IACN,CAAC,EACH,CAAC,cAENnB,KAAA,QAAKyD,SAAS,CAAC,WAAW,gHAAAD,QAAA,eAExB1D,IAAA,QAAK2D,SAAS,CAAC,UAAU,gHAAAD,QAAA,cAAA1D,IAAA,0JAAAwD,KAAA,EAAAC,OAAA,aAAAC,QAAA,cACvB1D,IAAA,CAACL,WAAW,EACVqF,QAAQ,CAAErE,OAAQ,CAClBsE,aAAa,CAAEhC,iBAAkB,CACjCiC,aAAa,CAAEjE,WAAY,CAC3BkE,OAAO,CAAEhC,gBAAiB,CAC3B,CAAC,GACC,CAAC,cAGNnD,IAAA,QAAK2D,SAAS,CAAC,aAAa,gHAAAD,QAAA,cAC1B1D,IAAA,QAAK2D,SAAS,CAAC,yFAAyF,+GAAAD,QAAA,CACrGvC,cAAc,cACbjB,KAAA,CAAAE,SAAA,EAAAsD,QAAA,eAAA1D,IAAA,uJAAAwD,KAAA,EAAAC,OAAA,aAAAC,QAAA,cACE1D,IAAA,CAACT,OAAO,EAACoE,SAAS,CAAC,SAAS,CAAE,CAAC,GAC9BtC,CAAC,CAAC,uBAAuB,CAAC,EAC3B,CAAC,cAEHnB,KAAA,CAAAE,SAAA,EAAAsD,QAAA,eAAA1D,IAAA,sJAAAwD,KAAA,EAAAC,OAAA,aAAAC,QAAA,cACE1D,IAAA,CAACb,MAAM,EAACwE,SAAS,CAAC,SAAS,CAAE,CAAC,GAC7BtC,CAAC,CAAC,qBAAqB,CAAC,EACzB,CACH,CACE,CAAC,CACH,CAAC,cAGNnB,KAAA,QAAKyD,SAAS,CAAC,2BAA2B,gHAAAD,QAAA,eAAA1D,IAAA,qJAAAwD,KAAA,EAAAC,OAAA,aAAAC,QAAA,cACxC1D,IAAA,CAACN,MAAM,EACL,cAAY,kBAAkB,CAC9BqF,OAAO,CAAC,SAAS,CACjBR,OAAO,CAAEA,CAAA,GAAM,CACb7D,eAAe,CAAC,IAAI,CAAC,CACrBE,UAAU,CAAC,IAAI,CAAC,CAChBI,SAAS,CAAC,IAAI,CAAC,CACfE,cAAc,CAAC,IAAI,CAAC,CACpBE,iBAAiB,CAAC,KAAK,CAAC,CAC1B,CAAE,CACFuC,SAAS,CAAC,iBAAiB,CAAAD,QAAA,CAE1BrC,CAAC,CAAC,uBAAuB,CAAC,CACrB,CAAC,gBAAArB,IAAA,qJAAAwD,KAAA,EAAAC,OAAA,aAAAC,QAAA,cACT1D,IAAA,CAACN,MAAM,EACL,cAAY,oBAAoB,CAChC6E,OAAO,CAAEA,CAAA,GAAI,CACXxC,cAAc,CAAC,CAAC,CACfqD,MAAM,CAACC,QAAQ,CAAC,CAAEC,GAAG,CAAEd,QAAQ,CAACe,IAAI,CAACC,YAAY,CAAEC,QAAQ,CAAE,QAAS,CAAC,CAAC,CACzE,CAAE,CACJC,QAAQ,CAAE7E,OAAQ,CAClB8C,SAAS,CAAC,sGAAsG,CAAAD,QAAA,CAE/G7C,OAAO,cACNX,KAAA,CAAAE,SAAA,EAAAsD,QAAA,eAAA1D,IAAA,uJAAAwD,KAAA,EAAAC,OAAA,aAAAC,QAAA,cACE1D,IAAA,CAACZ,OAAO,EAACuE,SAAS,CAAC,2BAA2B,CAAE,CAAC,GAChDtC,CAAC,CAAC,qBAAqB,CAAC,EACzB,CAAC,CAEHA,CAAC,CAAC,yBAAyB,CAC5B,CACK,CAAC,IACN,CAAC,EACH,CACN,CACS,CAAC,CAGZR,OAAO,eACNX,KAAA,CAACjB,MAAM,CAAC8E,GAAG,EACTC,OAAO,CAAE,CAAEC,OAAO,CAAE,CAAE,CAAE,CACxBE,OAAO,CAAE,CAAEF,OAAO,CAAE,CAAE,CAAE,CACxBN,SAAS,CAAC,iDAAiD,CAAAD,QAAA,eAAA1D,IAAA,uJAAAwD,KAAA,EAAAC,OAAA,aAAAC,QAAA,cAE3D1D,IAAA,CAACZ,OAAO,EAACuE,SAAS,CAAC,oDAAoD,CAAE,CAAC,gBAC1E3D,IAAA,MAAG2D,SAAS,CAAC,uBAAuB,6GAAAD,QAAA,CAAErC,CAAC,CAAC,uBAAuB,CAAC,CAAI,CAAC,EAC3D,CACb,CAGAN,MAAM,EAAI,CAACF,OAAO,eACjBX,KAAA,CAACjB,MAAM,CAAC8E,GAAG,EACTC,OAAO,CAAE,CAAEC,OAAO,CAAE,CAAC,CAAEC,CAAC,CAAE,EAAG,CAAE,CAC/BC,OAAO,CAAE,CAAEF,OAAO,CAAE,CAAC,CAAEC,CAAC,CAAE,CAAE,CAAE,CAC9BE,UAAU,CAAE,CAAEC,QAAQ,CAAE,GAAI,CAAE,CAC9B,cAAY,aAAa,CACzBV,SAAS,CAAC,6CAA6C,CAAAD,QAAA,eAEvD1D,IAAA,QAAK2D,SAAS,CAAC,kBAAkB,gHAAAD,QAAA,cAC/B1D,IAAA,OAAI2D,SAAS,CAAC,wCAAwC,+GAAAD,QAAA,CAAC,kBAEvD,CAAI,CAAC,CAOF,CAAC,cAENxD,KAAA,QAAKyD,SAAS,CAAC,WAAW,+GAAAD,QAAA,eAExBxD,KAAA,uHAAAwD,QAAA,eACE1D,IAAA,UAAO2D,SAAS,CAAC,8CAA8C,iHAAAD,QAAA,CAAErC,CAAC,CAAC,gCAAgC,CAAC,CAAQ,CAAC,cAC7GrB,IAAA,QACE,cAAY,YAAY,CACxB2D,SAAS,CAAC,mCAAmC,+GAAAD,QAAA,CAE5C3C,MAAM,CAAC4E,KAAK,CACV,CAAC,EACH,CAAC,cAGNzF,KAAA,uHAAAwD,QAAA,eACE1D,IAAA,UAAO2D,SAAS,CAAC,8CAA8C,iHAAAD,QAAA,CAAErC,CAAC,CAAC,gCAAgC,CAAC,CAAQ,CAAC,cAC7GrB,IAAA,QACE,cAAY,eAAe,CAC3B2D,SAAS,CAAC,mCAAmC,+GAAAD,QAAA,CAE5C3C,MAAM,CAAC6E,aAAa,CAClB,CAAC,EACH,CAAC,CAGL,CAAC7E,MAAM,CAAC8E,UAAU,GAAKC,SAAS,EAAI/E,MAAM,CAACgF,WAAW,gBACrD7F,KAAA,QAAKyD,SAAS,CAAC,uCAAuC,+GAAAD,QAAA,EACnD3C,MAAM,CAAC8E,UAAU,GAAKC,SAAS,eAC9B5F,KAAA,uHAAAwD,QAAA,eACE1D,IAAA,UAAO2D,SAAS,CAAC,8CAA8C,kHAAAD,QAAA,CAAC,YAAU,CAAO,CAAC,cAClFxD,KAAA,QAAKyD,SAAS,gFAAApD,MAAA,CAAiFqD,kBAAkB,CAAC7C,MAAM,CAAC8E,UAAU,CAAG,GAAG,CAAC,CAAG,+GAAAnC,QAAA,EAC1II,iBAAiB,CAAC/C,MAAM,CAAC8E,UAAU,CAAG,GAAG,CAAC,CAC1C,CAAC9E,MAAM,CAAC8E,UAAU,CAAG,GAAG,EAAEG,OAAO,CAAC,CAAC,CAAC,CAAC,GACxC,EAAK,CAAC,EACH,CACN,CACAjF,MAAM,CAACgF,WAAW,eACjB7F,KAAA,uHAAAwD,QAAA,eACE1D,IAAA,UAAO2D,SAAS,CAAC,8CAA8C,kHAAAD,QAAA,CAAC,YAAU,CAAO,CAAC,cAClFxD,KAAA,QAAKyD,SAAS,gFAAApD,MAAA,CACZQ,MAAM,CAACgF,WAAW,GAAK,OAAO,CAC1B,4BAA4B,CAC5B,8BAA8B,CACjC,+GAAArC,QAAA,eAAA1D,IAAA,oJAAAwD,KAAA,EAAAC,OAAA,aAAAC,QAAA,cACD1D,IAAA,CAACP,IAAI,EAACkE,SAAS,CAAC,SAAS,CAAE,CAAC,GAC3B5C,MAAM,CAACgF,WAAW,GAAK,OAAO,CAAG,aAAa,CAAG,mBAAmB,EAClE,CAAC,EACH,CACN,EACE,CACN,cAGD7F,KAAA,uHAAAwD,QAAA,eACE1D,IAAA,UAAO2D,SAAS,CAAC,8CAA8C,iHAAAD,QAAA,CAAErC,CAAC,CAAC,yBAAyB,CAAC,CAAQ,CAAC,cACtGnB,KAAA,QACE,cAAY,QAAQ,CACpByD,SAAS,gFAAApD,MAAA,CAAiF6C,cAAc,CAACrC,MAAM,CAACsC,MAAM,CAAC,CAAG,+GAAAK,QAAA,EAEzHH,aAAa,CAACxC,MAAM,CAACsC,MAAM,CAAC,CAC5BtC,MAAM,CAACsC,MAAM,EACX,CAAC,EACH,CAAC,cAINnD,KAAA,uHAAAwD,QAAA,eACE1D,IAAA,UAAO2D,SAAS,CAAC,8CAA8C,iHAAAD,QAAA,CAAErC,CAAC,CAAC,mCAAmC,CAAC,CAAQ,CAAC,cAChHnB,KAAA,QAAKyD,SAAS,CAAC,yBAAyB,gHAAAD,QAAA,eACtC1D,IAAA,QACE2D,SAAS,CAAC,gCAAgC,CAC1CH,KAAK,CAAE,CACLyC,eAAe,QAAA1F,MAAA,CAASQ,MAAM,CAACmF,YAAY,CAAC,CAAC,CAAC,OAAA3F,MAAA,CAAKQ,MAAM,CAACmF,YAAY,CAAC,CAAC,CAAC,OAAA3F,MAAA,CAAKQ,MAAM,CAACmF,YAAY,CAAC,CAAC,CAAC,KACtG,CAAE,gHACH,CAAC,cACFhG,KAAA,SAAMyD,SAAS,CAAC,uBAAuB,gHAAAD,QAAA,EAAC,KACnC,CAAC3C,MAAM,CAACmF,YAAY,CAAC,CAAC,CAAC,CAAC,OAAK,CAACnF,MAAM,CAACmF,YAAY,CAAC,CAAC,CAAC,CAAC,OAAK,CAACnF,MAAM,CAACmF,YAAY,CAAC,CAAC,CAAC,EAChF,CAAC,EACJ,CAAC,EACH,CAAC,EAiHH,CAAC,EACI,CACb,EACE,CAAC,CACH,CAAC,CAEV","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}