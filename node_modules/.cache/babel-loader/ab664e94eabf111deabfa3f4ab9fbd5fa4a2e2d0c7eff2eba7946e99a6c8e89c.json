{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\ADMIN\\\\Desktop\\\\Pharma\\\\Frontend\\\\src\\\\components\\\\ReadAloud.jsx\",\n  _s = $RefreshSig$();\nimport { useState, useEffect, useRef } from \"react\";\nimport { useTranslation } from \"react-i18next\";\nimport { Volume2, VolumeX, Loader2 } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ReadAloud = () => {\n  _s();\n  const {\n    i18n\n  } = useTranslation();\n  const [voices, setVoices] = useState([]);\n  const [isSpeaking, setIsSpeaking] = useState(false);\n  const [isLoading, setIsLoading] = useState(false);\n  const currentUtteranceRef = useRef(null);\n  const queueRef = useRef([]);\n  const isProcessingRef = useRef(false);\n\n  // Language code to voice locale mapping\n  const langToLocale = {\n    en: \"en-IN\",\n    es: \"es-ES\",\n    // Spanish fallback\n    hi: \"hi-IN\",\n    ta: \"ta-IN\",\n    ml: \"ml-IN\",\n    mr: \"mr-IN\",\n    gu: \"gu-IN\",\n    kn: \"kn-IN\",\n    raj: \"hi-IN\" // Rajasthani fallback to Hindi\n  };\n\n  // Load voices when component mounts\n  useEffect(() => {\n    const loadVoices = () => {\n      const availableVoices = window.speechSynthesis.getVoices();\n      setVoices(availableVoices);\n      // Log available voices for debugging\n      console.log(\"Available voices:\", availableVoices.map(v => ({\n        name: v.name,\n        lang: v.lang\n      })));\n    };\n\n    // Load voices immediately if available\n    loadVoices();\n\n    // Some browsers load voices asynchronously - trigger a reload\n    if (window.speechSynthesis.onvoiceschanged !== undefined) {\n      window.speechSynthesis.onvoiceschanged = loadVoices;\n    }\n\n    // Force voice loading on Chrome/Edge (they load voices asynchronously)\n    // Trigger onvoiceschanged event by calling getVoices multiple times\n    let attempts = 0;\n    const checkVoices = setInterval(() => {\n      const availableVoices = window.speechSynthesis.getVoices();\n      if (availableVoices.length > 0 || attempts > 10) {\n        setVoices(availableVoices);\n        clearInterval(checkVoices);\n        if (availableVoices.length > 0) {\n          console.log(\"Voices loaded:\", availableVoices.length);\n        }\n      }\n      attempts++;\n    }, 100);\n\n    // Cleanup: stop any ongoing speech when component unmounts\n    return () => {\n      clearInterval(checkVoices);\n      if (currentUtteranceRef.current) {\n        window.speechSynthesis.cancel();\n      }\n    };\n  }, []);\n\n  // Find the best matching voice for a given locale\n  const findVoice = locale => {\n    if (voices.length === 0) return null;\n\n    // First, try to find an exact match\n    let voice = voices.find(v => v.lang === locale);\n\n    // If no exact match, try to find a voice with the same language code\n    if (!voice) {\n      const langCode = locale.split(\"-\")[0];\n      voice = voices.find(v => v.lang.startsWith(langCode));\n    }\n\n    // If still no match, try to find any Indian voice\n    if (!voice) {\n      voice = voices.find(v => v.lang.includes(\"IN\"));\n    }\n\n    // Fallback to default voice\n    return voice || voices.find(v => v.default) || voices[0];\n  };\n\n  // Extract text content from the page, excluding navigation, footer, and buttons\n  const extractPageContent = () => {\n    // Selectors to exclude\n    const excludeSelectors = [\"nav\", \"footer\", \"button\", \"[role='button']\", \"[role='navigation']\", \".read-aloud-button\",\n    // Exclude the read-aloud button itself\n    \"script\", \"style\", \"noscript\", \"svg\",\n    // Exclude SVG icons\n    \"[aria-hidden='true']\" // Exclude hidden elements\n    ];\n\n    // Get the main content area (usually main, article, or the main div)\n    const mainContent = document.querySelector(\"main\") || document.querySelector(\"article\") || document.querySelector('[role=\"main\"]') || document.querySelector(\".App > div:not(nav):not(footer)\") || document.body;\n\n    // Clone the element to avoid modifying the original\n    const clone = mainContent.cloneNode(true);\n\n    // Remove excluded elements from clone\n    excludeSelectors.forEach(selector => {\n      try {\n        const elements = clone.querySelectorAll(selector);\n        elements.forEach(el => el.remove());\n      } catch (e) {\n        // Ignore selector errors\n      }\n    });\n\n    // Extract text from semantic elements (headings, paragraphs, list items, etc.)\n    const textElements = [];\n    const contentSelectors = \"h1, h2, h3, h4, h5, h6, p, li, td, th, label, span, div, blockquote, figcaption\";\n\n    // Get all content elements from the original DOM (not clone) to preserve structure\n    const allElements = mainContent.querySelectorAll(contentSelectors);\n    allElements.forEach(el => {\n      // Skip if element is in excluded areas\n      if (el.closest(\"nav\") || el.closest(\"header\") || el.closest(\"footer\") || el.closest(\"button\") || el.closest(\".read-aloud-button\") || el.closest(\"[role='button']\") || el.closest(\"[aria-hidden='true']\")) {\n        return;\n      }\n      const text = el.textContent.trim();\n\n      // Filter out very short texts, very long texts, and non-meaningful content\n      if (text.length >= 10 && text.length <= 2000 && !/^[0-9\\s\\-_\\.]+$/.test(text) &&\n      // Exclude pure numbers/symbols\n      !text.match(/^(EN|ES|HI|TA|ML|MR|GU)$/i) // Exclude language codes\n      ) {\n        // Check if this text is not a duplicate or substring of another\n        const isDuplicate = textElements.some(existing => existing === text || existing.includes(text) || text.includes(existing));\n        if (!isDuplicate) {\n          textElements.push(text);\n        }\n      }\n    });\n\n    // If we didn't get enough content, try a more aggressive approach\n    if (textElements.length < 3) {\n      const walker = document.createTreeWalker(mainContent, NodeFilter.SHOW_TEXT, null, false);\n      let node;\n      while (node = walker.nextNode()) {\n        // Skip if in excluded areas\n        let parent = node.parentElement;\n        let shouldSkip = false;\n        while (parent && parent !== mainContent) {\n          if (parent.tagName === \"NAV\" || parent.tagName === \"HEADER\" || parent.tagName === \"FOOTER\" || parent.tagName === \"BUTTON\" || parent.closest(\".read-aloud-button\") || parent.getAttribute(\"aria-hidden\") === \"true\") {\n            shouldSkip = true;\n            break;\n          }\n          parent = parent.parentElement;\n        }\n        if (shouldSkip) continue;\n        const text = node.textContent.trim();\n        if (text.length >= 10 && text.length <= 2000 && !/^[0-9\\s\\-_\\.]+$/.test(text)) {\n          const isDuplicate = textElements.some(existing => existing === text || existing.includes(text) || text.includes(existing));\n          if (!isDuplicate) {\n            textElements.push(text);\n          }\n        }\n      }\n    }\n\n    // Filter and return unique texts, limit to reasonable amount\n    return textElements.filter((text, index, self) => self.indexOf(text) === index).slice(0, 100); // Limit to first 100 text chunks\n  };\n\n  // Process the speech queue\n  const processQueue = () => {\n    var _i18n$language;\n    if (isProcessingRef.current || queueRef.current.length === 0) {\n      if (queueRef.current.length === 0) {\n        setIsSpeaking(false);\n        setIsLoading(false);\n      }\n      return;\n    }\n    isProcessingRef.current = true;\n    const text = queueRef.current.shift();\n    const currentLang = ((_i18n$language = i18n.language) === null || _i18n$language === void 0 ? void 0 : _i18n$language.split(\"-\")[0]) || \"en\";\n    const locale = langToLocale[currentLang] || langToLocale[\"en\"];\n\n    // Create utterance\n    const utterance = new SpeechSynthesisUtterance(text);\n    utterance.lang = locale;\n    utterance.rate = 0.9; // Slightly slower for better comprehension\n    utterance.pitch = 1.0;\n    utterance.volume = 1.0;\n\n    // Find and set the voice\n    const voice = findVoice(locale);\n    if (voice) {\n      utterance.voice = voice;\n    }\n\n    // Handle speech events\n    utterance.onend = () => {\n      isProcessingRef.current = false;\n      currentUtteranceRef.current = null;\n      // Process next item in queue\n      setTimeout(() => processQueue(), 100);\n    };\n    utterance.onerror = error => {\n      console.error(\"Speech synthesis error:\", error);\n      isProcessingRef.current = false;\n      currentUtteranceRef.current = null;\n      // Continue with next item\n      setTimeout(() => processQueue(), 100);\n    };\n\n    // Store reference and speak\n    currentUtteranceRef.current = utterance;\n    window.speechSynthesis.speak(utterance);\n  };\n\n  // Handle read aloud functionality\n  const handleReadAloud = () => {\n    if (isSpeaking) {\n      // Stop speaking\n      window.speechSynthesis.cancel();\n      queueRef.current = [];\n      isProcessingRef.current = false;\n      setIsSpeaking(false);\n      setIsLoading(false);\n      currentUtteranceRef.current = null;\n      return;\n    }\n\n    // Start reading\n    setIsLoading(true);\n    const texts = extractPageContent();\n    if (texts.length === 0) {\n      alert(\"No readable content found on this page.\");\n      setIsLoading(false);\n      return;\n    }\n\n    // Build queue\n    queueRef.current = texts;\n    setIsSpeaking(true);\n    setIsLoading(false);\n\n    // Start processing\n    processQueue();\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"fixed bottom-6 right-6 z-50\",\n    \"x-file-name\": \"ReadAloud\",\n    \"x-line-number\": \"313\",\n    \"x-component\": \"div\",\n    \"x-id\": \"ReadAloud_313\",\n    \"x-dynamic\": \"false\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      \"x-file-name\": \"ReadAloud\",\n      \"x-line-number\": \"314\",\n      \"x-component\": \"Button\",\n      \"x-id\": \"ReadAloud_314\",\n      \"x-dynamic\": \"true\",\n      \"data-debug-wrapper\": \"true\",\n      style: {\n        display: \"contents\"\n      },\n      children: /*#__PURE__*/_jsxDEV(Button, {\n        onClick: handleReadAloud,\n        className: \"read-aloud-button bg-[#2563EB] hover:bg-[#1E3A8A] text-white rounded-full shadow-lg h-14 w-14 p-0 flex items-center justify-center transition-all hover:scale-110\",\n        \"aria-label\": isSpeaking ? \"Stop reading\" : \"Read page aloud\",\n        title: isSpeaking ? \"Stop reading\" : \"Read page aloud\",\n        children: isLoading ? /*#__PURE__*/_jsxDEV(\"div\", {\n          \"x-file-name\": \"ReadAloud\",\n          \"x-line-number\": \"321\",\n          \"x-component\": \"Loader2\",\n          \"x-id\": \"ReadAloud_321\",\n          \"x-dynamic\": \"false\",\n          \"data-debug-wrapper\": \"true\",\n          style: {\n            display: \"contents\"\n          },\n          children: /*#__PURE__*/_jsxDEV(Loader2, {\n            className: \"h-6 w-6 animate-spin\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 321,\n            columnNumber: 11\n          }, this)\n        }, void 0, false) : isSpeaking ? /*#__PURE__*/_jsxDEV(\"div\", {\n          \"x-file-name\": \"ReadAloud\",\n          \"x-line-number\": \"323\",\n          \"x-component\": \"VolumeX\",\n          \"x-id\": \"ReadAloud_323\",\n          \"x-dynamic\": \"false\",\n          \"data-debug-wrapper\": \"true\",\n          style: {\n            display: \"contents\"\n          },\n          children: /*#__PURE__*/_jsxDEV(VolumeX, {\n            className: \"h-6 w-6\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 323,\n            columnNumber: 11\n          }, this)\n        }, void 0, false) : /*#__PURE__*/_jsxDEV(\"div\", {\n          \"x-file-name\": \"ReadAloud\",\n          \"x-line-number\": \"325\",\n          \"x-component\": \"Volume2\",\n          \"x-id\": \"ReadAloud_325\",\n          \"x-dynamic\": \"false\",\n          \"data-debug-wrapper\": \"true\",\n          style: {\n            display: \"contents\"\n          },\n          children: /*#__PURE__*/_jsxDEV(Volume2, {\n            className: \"h-6 w-6\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 325,\n            columnNumber: 11\n          }, this)\n        }, void 0, false)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 314,\n        columnNumber: 7\n      }, this)\n    }, void 0, false)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 313,\n    columnNumber: 5\n  }, this);\n};\n_s(ReadAloud, \"z9zYvPMcbjwU5nc3zZBJ+7OpNFM=\", false, function () {\n  return [useTranslation];\n});\n_c = ReadAloud;\nexport default ReadAloud;\nvar _c;\n$RefreshReg$(_c, \"ReadAloud\");","map":{"version":3,"names":["useState","useEffect","useRef","useTranslation","Volume2","VolumeX","Loader2","Button","jsxDEV","_jsxDEV","ReadAloud","_s","i18n","voices","setVoices","isSpeaking","setIsSpeaking","isLoading","setIsLoading","currentUtteranceRef","queueRef","isProcessingRef","langToLocale","en","es","hi","ta","ml","mr","gu","kn","raj","loadVoices","availableVoices","window","speechSynthesis","getVoices","console","log","map","v","name","lang","onvoiceschanged","undefined","attempts","checkVoices","setInterval","length","clearInterval","current","cancel","findVoice","locale","voice","find","langCode","split","startsWith","includes","default","extractPageContent","excludeSelectors","mainContent","document","querySelector","body","clone","cloneNode","forEach","selector","elements","querySelectorAll","el","remove","e","textElements","contentSelectors","allElements","closest","text","textContent","trim","test","match","isDuplicate","some","existing","push","walker","createTreeWalker","NodeFilter","SHOW_TEXT","node","nextNode","parent","parentElement","shouldSkip","tagName","getAttribute","filter","index","self","indexOf","slice","processQueue","_i18n$language","shift","currentLang","language","utterance","SpeechSynthesisUtterance","rate","pitch","volume","onend","setTimeout","onerror","error","speak","handleReadAloud","texts","alert","className","children","style","display","onClick","title","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/Users/ADMIN/Desktop/Pharma/Frontend/src/components/ReadAloud.jsx"],"sourcesContent":["import { useState, useEffect, useRef } from \"react\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { Volume2, VolumeX, Loader2 } from \"lucide-react\";\r\nimport { Button } from \"@/components/ui/button\";\r\n\r\nconst ReadAloud = () => {\r\n  const { i18n } = useTranslation();\r\n  const [voices, setVoices] = useState([]);\r\n  const [isSpeaking, setIsSpeaking] = useState(false);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const currentUtteranceRef = useRef(null);\r\n  const queueRef = useRef([]);\r\n  const isProcessingRef = useRef(false);\r\n\r\n  // Language code to voice locale mapping\r\n  const langToLocale = {\r\n    en: \"en-IN\",\r\n    es: \"es-ES\", // Spanish fallback\r\n    hi: \"hi-IN\",\r\n    ta: \"ta-IN\",\r\n    ml: \"ml-IN\",\r\n    mr: \"mr-IN\",\r\n    gu: \"gu-IN\",\r\n    kn: \"kn-IN\",\r\n    raj: \"hi-IN\", // Rajasthani fallback to Hindi\r\n  };\r\n\r\n  // Load voices when component mounts\r\n  useEffect(() => {\r\n    const loadVoices = () => {\r\n      const availableVoices = window.speechSynthesis.getVoices();\r\n      setVoices(availableVoices);\r\n      // Log available voices for debugging\r\n      console.log(\"Available voices:\", availableVoices.map(v => ({ name: v.name, lang: v.lang })));\r\n    };\r\n\r\n    // Load voices immediately if available\r\n    loadVoices();\r\n\r\n    // Some browsers load voices asynchronously - trigger a reload\r\n    if (window.speechSynthesis.onvoiceschanged !== undefined) {\r\n      window.speechSynthesis.onvoiceschanged = loadVoices;\r\n    }\r\n\r\n    // Force voice loading on Chrome/Edge (they load voices asynchronously)\r\n    // Trigger onvoiceschanged event by calling getVoices multiple times\r\n    let attempts = 0;\r\n    const checkVoices = setInterval(() => {\r\n      const availableVoices = window.speechSynthesis.getVoices();\r\n      if (availableVoices.length > 0 || attempts > 10) {\r\n        setVoices(availableVoices);\r\n        clearInterval(checkVoices);\r\n        if (availableVoices.length > 0) {\r\n          console.log(\"Voices loaded:\", availableVoices.length);\r\n        }\r\n      }\r\n      attempts++;\r\n    }, 100);\r\n\r\n    // Cleanup: stop any ongoing speech when component unmounts\r\n    return () => {\r\n      clearInterval(checkVoices);\r\n      if (currentUtteranceRef.current) {\r\n        window.speechSynthesis.cancel();\r\n      }\r\n    };\r\n  }, []);\r\n\r\n  // Find the best matching voice for a given locale\r\n  const findVoice = (locale) => {\r\n    if (voices.length === 0) return null;\r\n\r\n    // First, try to find an exact match\r\n    let voice = voices.find((v) => v.lang === locale);\r\n\r\n    // If no exact match, try to find a voice with the same language code\r\n    if (!voice) {\r\n      const langCode = locale.split(\"-\")[0];\r\n      voice = voices.find((v) => v.lang.startsWith(langCode));\r\n    }\r\n\r\n    // If still no match, try to find any Indian voice\r\n    if (!voice) {\r\n      voice = voices.find((v) => v.lang.includes(\"IN\"));\r\n    }\r\n\r\n    // Fallback to default voice\r\n    return voice || voices.find((v) => v.default) || voices[0];\r\n  };\r\n\r\n  // Extract text content from the page, excluding navigation, footer, and buttons\r\n  const extractPageContent = () => {\r\n    // Selectors to exclude\r\n    const excludeSelectors = [\r\n      \"nav\",\r\n      \r\n      \"footer\",\r\n      \"button\",\r\n      \"[role='button']\",\r\n      \"[role='navigation']\",\r\n      \".read-aloud-button\", // Exclude the read-aloud button itself\r\n      \"script\",\r\n      \"style\",\r\n      \"noscript\",\r\n      \"svg\", // Exclude SVG icons\r\n      \"[aria-hidden='true']\", // Exclude hidden elements\r\n    ];\r\n\r\n    // Get the main content area (usually main, article, or the main div)\r\n    const mainContent =\r\n      document.querySelector(\"main\") ||\r\n      document.querySelector(\"article\") ||\r\n      document.querySelector('[role=\"main\"]') ||\r\n      document.querySelector(\".App > div:not(nav):not(footer)\") ||\r\n      document.body;\r\n\r\n    // Clone the element to avoid modifying the original\r\n    const clone = mainContent.cloneNode(true);\r\n\r\n    // Remove excluded elements from clone\r\n    excludeSelectors.forEach((selector) => {\r\n      try {\r\n        const elements = clone.querySelectorAll(selector);\r\n        elements.forEach((el) => el.remove());\r\n      } catch (e) {\r\n        // Ignore selector errors\r\n      }\r\n    });\r\n\r\n    // Extract text from semantic elements (headings, paragraphs, list items, etc.)\r\n    const textElements = [];\r\n    const contentSelectors = \"h1, h2, h3, h4, h5, h6, p, li, td, th, label, span, div, blockquote, figcaption\";\r\n    \r\n    // Get all content elements from the original DOM (not clone) to preserve structure\r\n    const allElements = mainContent.querySelectorAll(contentSelectors);\r\n    \r\n    allElements.forEach((el) => {\r\n      // Skip if element is in excluded areas\r\n      if (\r\n        el.closest(\"nav\") ||\r\n        el.closest(\"header\") ||\r\n        el.closest(\"footer\") ||\r\n        el.closest(\"button\") ||\r\n        el.closest(\".read-aloud-button\") ||\r\n        el.closest(\"[role='button']\") ||\r\n        el.closest(\"[aria-hidden='true']\")\r\n      ) {\r\n        return;\r\n      }\r\n\r\n      const text = el.textContent.trim();\r\n      \r\n      // Filter out very short texts, very long texts, and non-meaningful content\r\n      if (\r\n        text.length >= 10 &&\r\n        text.length <= 2000 &&\r\n        !/^[0-9\\s\\-_\\.]+$/.test(text) && // Exclude pure numbers/symbols\r\n        !text.match(/^(EN|ES|HI|TA|ML|MR|GU)$/i) // Exclude language codes\r\n      ) {\r\n        // Check if this text is not a duplicate or substring of another\r\n        const isDuplicate = textElements.some(\r\n          (existing) =>\r\n            existing === text ||\r\n            existing.includes(text) ||\r\n            text.includes(existing)\r\n        );\r\n\r\n        if (!isDuplicate) {\r\n          textElements.push(text);\r\n        }\r\n      }\r\n    });\r\n\r\n    // If we didn't get enough content, try a more aggressive approach\r\n    if (textElements.length < 3) {\r\n      const walker = document.createTreeWalker(\r\n        mainContent,\r\n        NodeFilter.SHOW_TEXT,\r\n        null,\r\n        false\r\n      );\r\n\r\n      let node;\r\n      while ((node = walker.nextNode())) {\r\n        // Skip if in excluded areas\r\n        let parent = node.parentElement;\r\n        let shouldSkip = false;\r\n        while (parent && parent !== mainContent) {\r\n          if (\r\n            parent.tagName === \"NAV\" ||\r\n            parent.tagName === \"HEADER\" ||\r\n            parent.tagName === \"FOOTER\" ||\r\n            parent.tagName === \"BUTTON\" ||\r\n            parent.closest(\".read-aloud-button\") ||\r\n            parent.getAttribute(\"aria-hidden\") === \"true\"\r\n          ) {\r\n            shouldSkip = true;\r\n            break;\r\n          }\r\n          parent = parent.parentElement;\r\n        }\r\n\r\n        if (shouldSkip) continue;\r\n\r\n        const text = node.textContent.trim();\r\n        if (\r\n          text.length >= 10 &&\r\n          text.length <= 2000 &&\r\n          !/^[0-9\\s\\-_\\.]+$/.test(text)\r\n        ) {\r\n          const isDuplicate = textElements.some(\r\n            (existing) =>\r\n              existing === text ||\r\n              existing.includes(text) ||\r\n              text.includes(existing)\r\n          );\r\n\r\n          if (!isDuplicate) {\r\n            textElements.push(text);\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    // Filter and return unique texts, limit to reasonable amount\r\n    return textElements\r\n      .filter((text, index, self) => self.indexOf(text) === index)\r\n      .slice(0, 100); // Limit to first 100 text chunks\r\n  };\r\n\r\n  // Process the speech queue\r\n  const processQueue = () => {\r\n    if (isProcessingRef.current || queueRef.current.length === 0) {\r\n      if (queueRef.current.length === 0) {\r\n        setIsSpeaking(false);\r\n        setIsLoading(false);\r\n      }\r\n      return;\r\n    }\r\n\r\n    isProcessingRef.current = true;\r\n    const text = queueRef.current.shift();\r\n    const currentLang = i18n.language?.split(\"-\")[0] || \"en\";\r\n    const locale = langToLocale[currentLang] || langToLocale[\"en\"];\r\n\r\n    // Create utterance\r\n    const utterance = new SpeechSynthesisUtterance(text);\r\n    utterance.lang = locale;\r\n    utterance.rate = 0.9; // Slightly slower for better comprehension\r\n    utterance.pitch = 1.0;\r\n    utterance.volume = 1.0;\r\n\r\n    // Find and set the voice\r\n    const voice = findVoice(locale);\r\n    if (voice) {\r\n      utterance.voice = voice;\r\n    }\r\n\r\n    // Handle speech events\r\n    utterance.onend = () => {\r\n      isProcessingRef.current = false;\r\n      currentUtteranceRef.current = null;\r\n      // Process next item in queue\r\n      setTimeout(() => processQueue(), 100);\r\n    };\r\n\r\n    utterance.onerror = (error) => {\r\n      console.error(\"Speech synthesis error:\", error);\r\n      isProcessingRef.current = false;\r\n      currentUtteranceRef.current = null;\r\n      // Continue with next item\r\n      setTimeout(() => processQueue(), 100);\r\n    };\r\n\r\n    // Store reference and speak\r\n    currentUtteranceRef.current = utterance;\r\n    window.speechSynthesis.speak(utterance);\r\n  };\r\n\r\n  // Handle read aloud functionality\r\n  const handleReadAloud = () => {\r\n    if (isSpeaking) {\r\n      // Stop speaking\r\n      window.speechSynthesis.cancel();\r\n      queueRef.current = [];\r\n      isProcessingRef.current = false;\r\n      setIsSpeaking(false);\r\n      setIsLoading(false);\r\n      currentUtteranceRef.current = null;\r\n      return;\r\n    }\r\n\r\n    // Start reading\r\n    setIsLoading(true);\r\n    const texts = extractPageContent();\r\n\r\n    if (texts.length === 0) {\r\n      alert(\"No readable content found on this page.\");\r\n      setIsLoading(false);\r\n      return;\r\n    }\r\n\r\n    // Build queue\r\n    queueRef.current = texts;\r\n    setIsSpeaking(true);\r\n    setIsLoading(false);\r\n\r\n    // Start processing\r\n    processQueue();\r\n  };\r\n\r\n  return (\r\n    <div className=\"fixed bottom-6 right-6 z-50\">\r\n      <Button\r\n        onClick={handleReadAloud}\r\n        className=\"read-aloud-button bg-[#2563EB] hover:bg-[#1E3A8A] text-white rounded-full shadow-lg h-14 w-14 p-0 flex items-center justify-center transition-all hover:scale-110\"\r\n        aria-label={isSpeaking ? \"Stop reading\" : \"Read page aloud\"}\r\n        title={isSpeaking ? \"Stop reading\" : \"Read page aloud\"}\r\n      >\r\n        {isLoading ? (\r\n          <Loader2 className=\"h-6 w-6 animate-spin\" />\r\n        ) : isSpeaking ? (\r\n          <VolumeX className=\"h-6 w-6\" />\r\n        ) : (\r\n          <Volume2 className=\"h-6 w-6\" />\r\n        )}\r\n      </Button>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ReadAloud;\r\n\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}